# ğŸš€ PayStream V2 è‡ªåŠ¨å‘å¸ƒå¿«é€Ÿå¼€å§‹æŒ‡å—

æœ¬æŒ‡å—å¸®åŠ©ä½ å¿«é€Ÿé…ç½®GitHub Actionsè‡ªåŠ¨å‘å¸ƒPayStream V2åˆ°npmã€‚

## âš¡ å¿«é€Ÿé…ç½® (5åˆ†é’Ÿ)

### 1ï¸âƒ£ é…ç½®npm token

```bash
# 1. è®¿é—® https://www.npmjs.com/settings/tokens
# 2. åˆ›å»ºæ–°çš„ Automation token
# 3. å¤åˆ¶ token (æ ¼å¼: npm_xxxxxxxxxxxx)
```

### 2ï¸âƒ£ åœ¨GitHubä»“åº“æ·»åŠ Secret

```bash
# ä»“åº“è®¾ç½® â†’ Secrets and variables â†’ Actions
# æ·»åŠ  NPM_TOKEN = ä½ çš„npm token
```

### 3ï¸âƒ£ å¯é€‰ï¼šåˆ›å»ºEnvironment

```bash
# ä»“åº“è®¾ç½® â†’ Environments â†’ åˆ›å»º "npm-publish"
# æ·»åŠ ä¿æŠ¤è§„åˆ™å’ŒEnvironment Secret
```

## ğŸ¯ å‘å¸ƒæ–¹å¼

### æ–¹æ³•1: æ‰‹åŠ¨è§¦å‘å‘å¸ƒ

1. **è¿›å…¥Actionsé¡µé¢** â†’ é€‰æ‹© "Release & Publish"
2. **ç‚¹å‡» "Run workflow"**
3. **è¾“å…¥ç‰ˆæœ¬å·**ï¼š
   - æ­£å¼ç‰ˆï¼š`2.1.0` â†’ npm tag: `latest`
   - Betaç‰ˆï¼š`2.1.0-beta.1` â†’ npm tag: `beta`
   - Alphaç‰ˆï¼š`2.1.0-alpha.1` â†’ npm tag: `alpha`

### æ–¹æ³•2: åˆ›å»ºReleaseè‡ªåŠ¨å‘å¸ƒ

1. **åˆ›å»ºRelease**ï¼š`Releases` â†’ `Create a new release`
2. **Tagæ ¼å¼**ï¼š`v2.1.0` (å¿…é¡»ä»¥vå¼€å¤´)
3. **å‘å¸ƒ**ï¼šè‡ªåŠ¨è§¦å‘workflow

## ğŸ” WorkflowåŠŸèƒ½ç‰¹æ€§

æˆ‘ä»¬çš„GitHub Actions workflowå…·å¤‡ä»¥ä¸‹åŠŸèƒ½ï¼š

### âœ… å®Œæ•´çš„CI/CDæµç¨‹
- **å¤šNodeç‰ˆæœ¬æµ‹è¯•** (18, 20)
- **ä»£ç è´¨é‡æ£€æŸ¥** (ESLint, TypeScript)
- **æ„å»ºéªŒè¯** (tsup)
- **V2å¯¼å‡ºéªŒè¯** (ç¡®ä¿æ— V1ä»£ç )
- **å®‰å…¨å®¡è®¡** (pnpm audit)

### ğŸ¯ æ™ºèƒ½ç‰ˆæœ¬ç®¡ç†
- **è‡ªåŠ¨è¯†åˆ«ç‰ˆæœ¬ç±»å‹**
- **è‡ªåŠ¨é€‰æ‹©npm tag**
- **æ”¯æŒé¢„å‘å¸ƒç‰ˆæœ¬**
- **è‡ªåŠ¨åˆ›å»ºGitHub Release**

### ğŸ›¡ï¸ å®‰å…¨å’Œç›‘æ§
- **Environmentä¿æŠ¤**
- **æ„å»ºç¼“å­˜ä¼˜åŒ–**
- **è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—**
- **å¤±è´¥è‡ªåŠ¨é€šçŸ¥**

## ğŸ“‹ æ‰€æœ‰é…ç½®æ–‡ä»¶

é¡¹ç›®ä¸­åŒ…å«ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š

```
â”œâ”€â”€ .github/workflows/
â”‚   â”œâ”€â”€ ci.yml           # æŒç»­é›†æˆ
â”‚   â””â”€â”€ release.yml      # å‘å¸ƒworkflow
â”œâ”€â”€ package.json         # V2é…ç½®ï¼Œç‰ˆæœ¬2.0.0
â”œâ”€â”€ CHANGELOG.md         # ç‰ˆæœ¬å˜æ›´è®°å½•
â””â”€â”€ docs/
    â”œâ”€â”€ github-actions-setup.md  # è¯¦ç»†è®¾ç½®æŒ‡å—
    â””â”€â”€ release-quick-start.md   # æœ¬æ–‡ä»¶
```

## ğŸš¦ å‘å¸ƒçŠ¶æ€æ£€æŸ¥

### éªŒè¯å‘å¸ƒæˆåŠŸ

```bash
# æ£€æŸ¥npmåŒ…ä¿¡æ¯
npm view paystream

# æ£€æŸ¥ç‰ˆæœ¬åˆ—è¡¨
npm view paystream versions --json

# æœ¬åœ°å®‰è£…æµ‹è¯•
npm install paystream@latest
# æˆ– npm install paystream@beta
```

### ç›‘æ§ActionsçŠ¶æ€

- âœ… **æˆåŠŸ**ï¼šç»¿è‰²å‹¾å·ï¼ŒåŒ…å·²å‘å¸ƒåˆ°npm
- âŒ **å¤±è´¥**ï¼šçº¢è‰²å‰å·ï¼ŒæŸ¥çœ‹æ—¥å¿—æ’é”™
- ğŸŸ¡ **è¿›è¡Œä¸­**ï¼šé»„è‰²åœ†ç‚¹ï¼Œæ­£åœ¨æ‰§è¡Œ

## ğŸ”§ å¸¸è§å‘å¸ƒåœºæ™¯

### åœºæ™¯1: å‘å¸ƒæ­£å¼ç‰ˆæœ¬

```bash
# æ–¹æ³•1: æ‰‹åŠ¨è§¦å‘
# Actions â†’ Run workflow â†’ è¾“å…¥ "2.1.0" â†’ latest

# æ–¹æ³•2: åˆ›å»ºRelease
# Releases â†’ Create Release â†’ Tag "v2.1.0"
```

### åœºæ™¯2: å‘å¸ƒBetaç‰ˆæœ¬

```bash
# æ–¹æ³•1: æ‰‹åŠ¨è§¦å‘
# Actions â†’ Run workflow â†’ è¾“å…¥ "2.1.0-beta.1" â†’ beta

# æ–¹æ³•2: æœ¬åœ°å‘å¸ƒ
npm version 2.1.0-beta.1
git push --tags
# ç„¶ååˆ›å»ºRelease
```

### åœºæ™¯3: å¿«é€Ÿä¿®å¤ç‰ˆæœ¬

```bash
# ç‰ˆæœ¬å·: 2.0.1 (patchç‰ˆæœ¬)
# è‡ªåŠ¨è¯†åˆ«ä¸º latest tag
```

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜1: NPM_TOKENå¤±æ•ˆ
```bash
# ç—‡çŠ¶: 401 Unauthorized
# è§£å†³: é‡æ–°ç”Ÿæˆtokenå¹¶æ›´æ–°GitHub Secret
```

### é—®é¢˜2: ç‰ˆæœ¬å·å†²çª
```bash
# ç—‡çŠ¶: 403 You cannot publish over existing version
# è§£å†³: æ£€æŸ¥npmç‰ˆæœ¬ï¼Œæ›´æ–°package.jsonç‰ˆæœ¬å·
```

### é—®é¢˜3: æ„å»ºå¤±è´¥
```bash
# ç—‡çŠ¶: Buildå¤±è´¥
# è§£å†³: æ£€æŸ¥TypeScripté”™è¯¯ï¼Œç¡®ä¿pnpm buildæœ¬åœ°æˆåŠŸ
```

## ğŸ“Š é¢„æœŸç»“æœ

é…ç½®å®Œæˆåï¼Œä½ å°†è·å¾—ï¼š

- âœ… **å®Œå…¨è‡ªåŠ¨åŒ–**çš„npmå‘å¸ƒæµç¨‹
- âœ… **å¤šç¯å¢ƒæ”¯æŒ** (latest, beta, alpha)
- âœ… **å®‰å…¨çš„**tokenç®¡ç†
- âœ… **å®Œæ•´çš„**CI/CDæµæ°´çº¿
- âœ… **è¯¦ç»†çš„**å‘å¸ƒæ—¥å¿—å’Œé€šçŸ¥

## ğŸ‰ ä¸‹ä¸€æ­¥

1. **æµ‹è¯•å‘å¸ƒ**ï¼šåˆ›å»ºä¸€ä¸ªbetaç‰ˆæœ¬æµ‹è¯•workflow
2. **è®¾ç½®é€šçŸ¥**ï¼šé…ç½®Slack/é‚®ä»¶é€šçŸ¥å‘å¸ƒçŠ¶æ€
3. **ç›‘æ§ä½¿ç”¨**ï¼šå…³æ³¨npmä¸‹è½½é‡å’Œç”¨æˆ·åé¦ˆ
4. **æŒç»­ä¼˜åŒ–**ï¼šæ ¹æ®ä½¿ç”¨æƒ…å†µè°ƒæ•´å‘å¸ƒç­–ç•¥

---

**ğŸš€ ç°åœ¨ä½ çš„PayStream V2å·²ç»å…·å¤‡äº†ç”Ÿäº§çº§çš„è‡ªåŠ¨åŒ–å‘å¸ƒèƒ½åŠ›ï¼** 